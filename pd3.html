<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Práctica dirigida 3</title>

<script src="site_libs/header-attrs-2.27/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Material para pds</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Inicio</a>
</li>
<li>
  <a href="pd1.html">Práctica dirigida 1</a>
</li>
<li>
  <a href="pd2.html">Práctica dirigida 2</a>
</li>
<li>
  <a href="pd3.html">Práctica dirigida 3</a>
</li>
<li>
  <a href="pd4.html">Práctica dirigida 4</a>
</li>
<li>
  <a href="pd5.html">Práctica dirigida 5</a>
</li>
<li>
  <a href="pd6.html">Práctica dirigida 6</a>
</li>
<li>
  <a href="pd7.html">Práctica dirigida 7</a>
</li>
<li>
  <a href="pd8.html">Práctica dirigida 8</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Práctica dirigida 3</h1>

</div>


<p><strong>FACULTAD DE CIENCIAS SOCIALES - PUCP</strong></p>
<p>Curso: SOC294 - Estadística para el análisis sociológico 2</p>
<p>Semestre 2025 - 1</p>
<div id="supuestos-del-modelo-de-regresión-lineal-y-diagnóstico"
class="section level1">
<h1><strong>1.Supuestos del Modelo de Regresión Lineal y
Diagnóstico</strong></h1>
<div id="el-error-o-los-residuos-de-un-modelo-de-regresión"
class="section level2">
<h2><strong>El Error o los Residuos de un Modelo de
Regresión</strong></h2>
<p>Los residuales o residuos de un modelo de regresión son la diferencia
entre el valor observado de la variable dependiente y el valor esperado
de la misma que se calcula mediante la ecuación de regresión.</p>
<p><em>e=y−y^</em></p>
</div>
<div id="supuestos-del-modelo-de-regresión-lineal"
class="section level2">
<h2><strong>Supuestos del Modelo de Regresión Lineal</strong></h2>
<p>La regresión lineal asume que los datos deben cumplir los siguientes
supuestos, que se verifican analizando el patron de distribución de los
residuos:</p>
<ul>
<li><p><strong>Linealidad:</strong> La relación entre la variable
dependiente (Y) y la variable independiente (X) debe ser lineal</p></li>
<li><p><strong>Normalidad de los residuos</strong>: Los residuos deben
tener una distribución normal.</p></li>
<li><p><strong>Homogeneidad de la varianza de los residuos</strong>: Los
residuos deben tener una varianza constante (homocedasticidad).</p></li>
<li><p><strong>Independencia de los residuos</strong>: Los residuos
deben ser independientes los unos de los otros, no deben estar
correlacionados entre sí.</p></li>
</ul>
</div>
<div id="problemas-de-violación-de-los-supuestos"
class="section level2">
<h2><strong>Problemas de violación de los supuestos</strong></h2>
<p>Es necesario verificar estos supuestos, los problemas potenciales que
pueden aparecer son:</p>
<ul>
<li><p>No linearidad de la relación entre las variables</p></li>
<li><p>Heterocedasticidad: Errores no constantes de los
residuos</p></li>
<li><p>Presencia de valores influyentes en los datos, que pueden
ser:</p>
<ul>
<li><p>Outliers o valores atípicos en la variable dependiente
(Y)</p></li>
<li><p>Puntos con alto efecto de palanca: valores extremos en la
variable independiente (X)</p></li>
</ul></li>
<li><p>Autocorrelación: Los valores de Y de un caso están relacionados
con los valores de Y en otro caso, esto puede ser: Autocorrelación
temporal: problemas con series de tiempo Autocorrelación espacial:
problemas con casos cercanos o vecinos espacialmente</p></li>
</ul>
<div id="diagnóstico-de-los-supuestos-de-regresión"
class="section level3">
<h3>Diagnóstico de los supuestos de regresión</h3>
<p>Para evaluar si un modelo de regresión cumple con los supuestos
indicados se utilizan un conjunto de gráficos de residuales:</p>
<ul>
<li><p>Para linealidad: Residuos vs Valores Esperados de Y</p></li>
<li><p>Para normalidad: Residuos vs distribución normal (Normal
Q-Q)</p></li>
<li><p>Para homocedasticidad: Scale-location plot</p></li>
<li><p>Para valores influyentes: Residuales vs leverage plot</p></li>
</ul>
</div>
</div>
<div id="ejercicio-práctico." class="section level2">
<h2>Ejercicio práctico.</h2>
<pre class="r"><code>library(rio)
data=import(&quot;PeruData.csv&quot;)</code></pre>
<p>Explicación de la data:</p>
<p>En los últimos años, se ha documentado un declive de la mortalidad
infantil tanto a nivel de Perú como en América Latina.</p>
<p>Se ha argumentado que el proceso de descenso de la mortalidad
infantil puede ser explicado por un conjunto de invertenciones en salud
pública y por las mejoras de las condiciones de vida de la
población.</p>
<p>Unidad de análisis: Provincias</p>
<div id="variable-dependiente-y-mortalidad-infantil"
class="section level3">
<h3>Variable dependiente (Y): mortalidad infantil</h3>
<pre class="r"><code>library(tidyverse)
data %&gt;%
 summarize(Min = min(mortalidadinf),
           Media = mean(mortalidadinf),
           Mediana = median(mortalidadinf),
           Max = max(mortalidadinf))</code></pre>
<pre><code>##   Min   Media Mediana  Max
## 1 9.2 23.8959      23 52.1</code></pre>
<pre class="r"><code>ggplot(data, aes(x = mortalidadinf)) + 
  geom_histogram(binwidth = 5, fill=&quot;orange&quot;, col=&quot;grey&quot;) +
  scale_x_continuous(breaks = seq(0,55,10), lim = c(0,55))+
  theme_minimal()</code></pre>
<p><img src="pd3_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="variable-independiente-1-índice-de-densidad-estatal"
class="section level3">
<h3>Variable Independiente 1: Índice de Densidad Estatal</h3>
<pre class="r"><code>data %&gt;%
 summarize(Min = min(IDE),
           Media = mean(IDE),
           Mediana = median(IDE),
           Max = max(IDE))</code></pre>
<pre><code>##      Min     Media Mediana    Max
## 1 0.4245 0.6519226  0.6367 0.9104</code></pre>
</div>
<div id="variable-independiente-2-ingresos-per-cápita"
class="section level3">
<h3>Variable Independiente 2: ingresos per cápita</h3>
<pre class="r"><code>data %&gt;%
 summarize(Min = min(percapitaf),
           Media = mean(percapitaf),
           Mediana = median(percapitaf),
           Max = max(percapitaf))</code></pre>
<pre><code>##        Min    Media  Mediana      Max
## 1 107.7527 241.5346 212.2963 556.4218</code></pre>
</div>
</div>
<div id="modelos-de-regresión" class="section level2">
<h2><strong>Modelos de regresión</strong></h2>
<pre class="r"><code>library(ggplot2)
library(stargazer)
library(ggfortify)

modelo1=lm(mortalidadinf~IDE, data=data)
modelo2=lm(mortalidadinf~percapitaf, data=data)
stargazer::stargazer(modelo1,modelo2, type=&#39;text&#39;)</code></pre>
<pre><code>## 
## ===========================================================
##                                    Dependent variable:     
##                                ----------------------------
##                                       mortalidadinf        
##                                     (1)            (2)     
## -----------------------------------------------------------
## IDE                              -46.847***                
##                                   (5.016)                  
##                                                            
## percapitaf                                      -0.056***  
##                                                  (0.005)   
##                                                            
## Constant                         54.437***      37.487***  
##                                   (3.309)        (1.301)   
##                                                            
## -----------------------------------------------------------
## Observations                        195            195     
## R2                                 0.311          0.395    
## Adjusted R2                        0.308          0.392    
## Residual Std. Error (df = 193)     7.060          6.619    
## F Statistic (df = 1; 193)        87.241***     125.846***  
## ===========================================================
## Note:                           *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
<div id="gráfico-para-diagnóstico-de-linealidad" class="section level3">
<h3><strong>Gráfico para Diagnóstico de Linealidad</strong></h3>
<pre class="r"><code>par(mfrow=c(1,2))
plot(modelo1, 1, caption = &quot;Modelo 1&quot;)
plot(modelo2, 1, caption = &quot;Modelo 2&quot;)</code></pre>
<p><img src="pd3_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Lo que debemos esperar de este gráfico es que no aparezca un patrón
lineal entre los residuales y los valores pronosticados de Y (y^). En
tal sentido el modelo 1 cumple mejor este supuesto que el modelo 2.</p>
</div>
<div id="gráficos-para-diagnóstico-de-normalidad"
class="section level3">
<h3><strong>Gráficos para Diagnóstico de Normalidad</strong></h3>
<pre class="r"><code>par(mfrow=c(2,2))
plot(modelo1, 2, caption = &quot;Modelo 1&quot;)
plot(modelo2, 2, caption = &quot;Modelo 2&quot;)
plot(density(modelo1$residuals))
plot(density(modelo2$residuals))</code></pre>
<p><img src="pd3_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Para el primer par de gráficos, en el eje vertical se muestran los
residuos estandarizados. En este caso la expectativa es que los puntos
se acercen lo más posible a la línea oblicua del gráfico que representa
una distribución normal. Ambos modelos tienen una distribución de
residuos asimétrica, pero la asimetría es ligeramente más acentuada en
el modelo 2.</p>
</div>
<div id="diagnóstico-de-homocedasticidad" class="section level3">
<h3><strong>Diagnóstico de homocedasticidad</strong></h3>
<pre class="r"><code>par(mfrow=c(1,2))
plot(modelo1, 3, caption = &quot;Modelo 1&quot;)
plot(modelo2, 3, caption = &quot;Modelo 2&quot;)</code></pre>
<p><img src="pd3_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>En este caso, se espera que la dispersión de la raiz cuadrada de los
residuos estandarizados no presente muchas variaciones según los valores
esperados de Y.</p>
</div>
<div
id="diagnóstico-de-observaciones-influyentes-leverage-palanca-y-valores-atípicos"
class="section level3">
<h3><strong>Diagnóstico de Observaciones Influyentes: “Leverage”
(palanca) y Valores Atípicos</strong></h3>
<pre class="r"><code>par(mfrow=c(1,2))
plot(modelo1, 5, caption = &quot;Modelo 1&quot;)
plot(modelo2, 5, caption = &quot;Modelo 2&quot;)</code></pre>
<p><img src="pd3_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="análisis-de-casos-extremos-e-influyentes"
class="section level3">
<h3><strong>Análisis de casos extremos e influyentes</strong></h3>
<p>En los gráficos de diagnóstico de modelos lineales en R, los números
que aparecen en la esquina superior (como 0.5 y 1.0) suelen corresponder
a los valores de apalancamiento (leverage). Estos valores indican la
influencia potencial de cada observación en el ajuste del modelo.</p>
<p>¿Qué es el apalancamiento (leverage)? El apalancamiento mide cuánto
influye una observación en la estimación de los coeficientes del
modelo.</p>
<p>Se calcula a partir de la matriz de diseño del modelo y depende de la
distancia de cada observación respecto al centro de los datos.</p>
<p>Los valores de apalancamiento están en el rango [0, 1]:</p>
<ul>
<li><p>0: La observación no tiene influencia en el modelo.</p></li>
<li><p>1: La observación tiene la máxima influencia (es un punto
extremo).</p></li>
</ul>
<p>¿Qué significan 0.5 y 1.0 en el gráfico?</p>
<p>0.5 y 1.0 son valores de referencia para el apalancamiento:</p>
<ul>
<li><p>0.5: Es un umbral común para identificar observaciones con
apalancamiento moderado o alto.</p></li>
<li><p>1.0: Es el valor máximo de apalancamiento, que indica que la
observación es un punto extremo con gran influencia en el
modelo.</p></li>
</ul>
</div>
<div id="qué-hacer-si-detectamos-problemas" class="section level3">
<h3>¿Qué hacer si detectamos problemas?</h3>
<p>Por lo general cuando nuestros modelos de regresión presentan alguno
de los problemas mencionados, ello puede significar que:</p>
<p>Algunas variables presentan distribuciones muy asimétricas (problemas
de linealidad y normalidad): En estos casos podemos tratar de cambiar la
escala de las mismas ascendiendo o descendiendo en la escalera de
potencia (utilizando una transformación logarítmica, por ejemplo).
Nuestros modelos están sub especificados (problemas de linealidad o de
heterocedasticidad): Estamos omitiendo alguna(s) variable(s)
importante(s) que puede(n) explicar patrones no lineales o varianzas no
homogéneas de los residuales. Casos extremos con valores muy atípicos:
un caso particular que no se ajusta al patrón general y que dificulta la
estimación de los coeficientes de regresión, en estas situaciones
podemos excluir esos casos del análisis, previa justificación.</p>
</div>
<div id="posible-solución" class="section level3">
<h3>Posible solución:</h3>
<p>Transformar variables e incluir otras variables predictoras:</p>
<pre class="r"><code>modelo3=lm(log(mortalidadinf)~log10(percapitaf), data=data)

stargazer(modelo1, modelo2, modelo3, type = &quot;text&quot;,
          omit.stat=c(&quot;ser&quot;,&quot;f&quot;), 
          star.cutoffs = c(0.05, 0.01, 0.001))</code></pre>
<pre><code>## 
## =========================================================
##                             Dependent variable:          
##                   ---------------------------------------
##                      mortalidadinf     log(mortalidadinf)
##                      (1)        (2)           (3)        
## ---------------------------------------------------------
## IDE               -46.847***                             
##                    (5.016)                               
##                                                          
## percapitaf                   -0.056***                   
##                               (0.005)                    
##                                                          
## log10(percapitaf)                          -1.565***     
##                                             (0.122)      
##                                                          
## Constant          54.437***  37.487***      6.792***     
##                    (3.309)    (1.301)       (0.287)      
##                                                          
## ---------------------------------------------------------
## Observations         195        195           195        
## R2                  0.311      0.395         0.462       
## Adjusted R2         0.308      0.392         0.459       
## =========================================================
## Note:                       *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</code></pre>
<pre class="r"><code>autoplot(modelo3)</code></pre>
<p><img src="pd3_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
